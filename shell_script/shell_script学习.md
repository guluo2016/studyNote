**shell script学习**


### 1 文件头

`#！/bin/bash` 该行代码用于指定使用/bin目录下的bash程序来解释执行该脚本文件
脚本内部某一行的错误并不影响接下来代码的执行。

**注意：在执行脚本时使用指令：`./test.sh`，而不是指令：`test.sh`,原因在于，通过后者方式执行，bash会在PATH中寻找test.sh脚本文件，但是根本没有啊，因此会报错信息：找不到脚本文件；通过前者方式执行，实际上告诉了bash，脚本就在当前目录下。**


### 2 变量

基础：
- 定义`变量名=value`对变量进行声明，注意等号两边不能有空格；注意在声明完变量之后，使用`readonly 变量名`可将变量声明为只读变量，只读变量不能在被重新赋值；
- 使用变量：`${变量名}`即可获取变量值；
- 删除变量：`unset 变量名`

变量类型：（以后细看）
- 局部变量
- 环境变量
- shell变量

### 3 字符串
- 声明字符串的方式和声明变量的方式一样
- 声明字符串时，建议使用双引号，因为这样可以在字符串内部引用其他变量；
- 获取字符串长度：`${#str_name}`
- 获取字符串的子串：`${str_name:start:end}` start和end是数字


### 4 数组

- shell不支持多维数组
- 数组的声明方式： array_name=(A B C)`,注意数组用括号将数组元素包含起来，内部元素用空格进行分割；
- 另外一种声明数组方式：
```
array_name[0]=A
array_name[1]=B
...
```
- 使用数组：`${array_name[0]}`
- 使用@获取数组所有元素：`${array_name[@]}`
- 获取数组长度：`${#array_name[@]}`

### 5 注释

shell script中注释都是以#开头的（文件的第一行例外，那是一个约定的规则）

### 6 传递参数

- 我们在执行shell脚本的同时，可以向该脚本传递若干参数，如现有以test.sh脚本,执行指令如下：
`./test.sh 1 2 "shenzhen"`
那么在脚本内部，我们就可以使用$1,$2,...获取参数，其中$n中的为几，就获取所传递的第几个参数,注意参数是从1开始的
- 在脚本内部使用$#获取执行脚本传递的参数总个数
- $$显示当前脚本运行时的pid

### 7 运算

- bash不支持+，-，*,/,需要借助与其他算数计算工具来实现加减乘除运算，可以借助于expr工具实现。
- expr实现基本运算：`expr $a + $b`,也可以是-，\*,/,%等基本操作，注意乘法；
- 进行运算时注意：运算符两边必须有空格，运算表达式需要使用``括起来
- 当参与运算的参数有非数字时，会报错：`expr: 非整数参数`

### 8 关系运算符
- 注意关系运算仅支持数组,据我自己测试，关系运算并不能将运算结果赋值给变量
- 等于（-eq）：[ $a -eq $b ]，
- 不等于(-ne): [ $a -ne $b ]
- 大于(-gt)
- 小于（-lt）
- 大于等于（-ge）
- 小于等于（-le）
- 非运算（！）：[ !false ]

### 9 逻辑流程
最常用的就是if，while等等
**if条件句**
- `if [ 条件 ]；then 语句；fi`写成一行的形式
- if-else
```
if [ 条件 ]
then
	语句
else
	语句
fi
```
- if-else-if
```
if [ 条件 ]
then 
	语句
elif [ 条件 ]
then 
	语句
else
	语句
fi
```

**for循环**

- 如下语句表示（自己理解），一次遍历items，并将每一个items赋值给(变量名),直至遍历完items；假如是数组array时，下面的item可以换成`${array[@]}`，表示遍历数组array中的所有元素并赋值非(变量名)
```
for 变量名 in item1 item2 item3 ... itemN
do
	语句
done
```

**while循环**

- 

```
while [ 条件 ]
do
	语句
done
```
-
```
#如果想无限循环，可以如下
while ：
do
	语句
done
```
-
```
#或者
while true
do
	语句
done
```

### 10 函数

- 函数的声明方式如下，函数的返回值可以显示声明，也可以省略，当没有return语句时，函数默认将函数内最后一条命令执行的结果，作为返回值返回（0-225）,0表示执行成功，返回值只能是数字；
- 函数返回值显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误
- 在函数内获取参数的方法 $N 获取第N个参数，注意，当参数N>=10时，获取第10以上（包括第10）个参数的方法是 ${N}，必须加中括号
```
[function] fun_name(){
	语句
    return 语句
}
```
- 调用函数：
```
#方式1
fun_name
#方式2（带参数）
fun_name 1 2 3 4...
#方式3，获取函数返回值，在调用方法之后，紧跟语句 $? 用于获取函数返回值
fun_name [参数]
```

### 11 包含外部文件
有两种方式指定外部文件

- `. 文件路径/filename`  注意.和文件路径之间必须存在空格
-  source 文件路径/filenam
